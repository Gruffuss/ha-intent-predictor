2025-07-13 08:40:33,064 - __main__ - INFO - Starting Simple Intent Prediction System
2025-07-13 08:40:33,070 - __main__ - INFO - Configuration loaded from /home/intent-predictor/ha-intent-predictor/config/config.yaml
2025-07-13 08:40:33,070 - __main__ - INFO - Starting main application loop
2025-07-13 08:40:33,070 - __main__ - INFO - Initializing application
2025-07-13 08:40:33,073 - ha_client - INFO - Successfully connected to Home Assistant
2025-07-13 08:40:33,073 - __main__ - INFO - Creating output sensors in Home Assistant
2025-07-13 08:40:33,109 - __main__ - INFO - Training new models from scratch
2025-07-13 08:40:33,109 - __main__ - INFO - Starting initial training with historical data
2025-07-13 08:40:33,109 - __main__ - INFO - Fetching historical sensor data
2025-07-13 08:40:33,109 - ha_client - INFO - Fetching 30 days of historical data for 23 entities
2025-07-13 08:40:40,666 - ha_client - INFO - Retrieved 85875 historical records
2025-07-13 08:40:40,675 - __main__ - INFO - Retrieved 85875 historical records
2025-07-13 08:40:40,676 - __main__ - INFO - Fitting feature engineering pipeline
2025-07-13 08:40:40,676 - simple_feature_engine - INFO - Fitting feature engineering pipeline
2025-07-13 08:40:40,691 - simple_feature_engine - INFO - Feature pipeline fitted with 44 features
2025-07-13 08:40:40,692 - simple_feature_engine - INFO - Feature names: ['hour', 'day_of_week', 'is_weekend', 'hour_sin', 'hour_cos', 'day_sin', 'day_cos', 'office_activity_5min', 'office_activity_pct_5min', 'office_activity_15min', 'office_activity_pct_15min', 'office_activity_30min', 'office_activity_pct_30min', 'office_activity_60min', 'office_activity_pct_60min', 'office_last_seen_minutes', 'office_current_score', 'bedroom_activity_5min', 'bedroom_activity_pct_5min', 'bedroom_activity_15min', 'bedroom_activity_pct_15min', 'bedroom_activity_30min', 'bedroom_activity_pct_30min', 'bedroom_activity_60min', 'bedroom_activity_pct_60min', 'bedroom_last_seen_minutes', 'bedroom_current_score', 'kitchen_livingroom_activity_5min', 'kitchen_livingroom_activity_pct_5min', 'kitchen_livingroom_activity_15min', 'kitchen_livingroom_activity_pct_15min', 'kitchen_livingroom_activity_30min', 'kitchen_livingroom_activity_pct_30min', 'kitchen_livingroom_activity_60min', 'kitchen_livingroom_activity_pct_60min', 'kitchen_livingroom_last_seen_minutes', 'kitchen_livingroom_current_score', 'total_activity_2h', 'office_activity_2h', 'office_activity_2h_pct', 'bedroom_activity_2h', 'bedroom_activity_2h_pct', 'kitchen_livingroom_activity_2h', 'kitchen_livingroom_activity_2h_pct']
2025-07-13 08:40:40,692 - simple_feature_engine - INFO - Feature engineering pipeline fitted successfully
2025-07-13 08:40:40,692 - __main__ - INFO - Extracting features for training
2025-07-13 08:40:40,705 - __main__ - INFO - Using 714 time points for training
2025-07-13 08:40:40,705 - __main__ - INFO - Feature extraction progress: 0.0% (0/714)
2025-07-13 08:40:42,147 - __main__ - INFO - Feature extraction progress: 14.0% (100/714)
2025-07-13 08:40:43,365 - __main__ - INFO - Feature extraction progress: 28.0% (200/714)
2025-07-13 08:40:43,756 - __main__ - INFO - Feature extraction progress: 42.0% (300/714)
2025-07-13 08:40:45,310 - __main__ - INFO - Feature extraction progress: 56.0% (400/714)
2025-07-13 08:40:46,552 - __main__ - INFO - Feature extraction progress: 70.0% (500/714)
2025-07-13 08:40:47,755 - __main__ - INFO - Feature extraction progress: 84.0% (600/714)
2025-07-13 08:40:48,966 - __main__ - INFO - Feature extraction progress: 98.0% (700/714)
2025-07-13 08:40:49,460 - __main__ - INFO - Extracted 641 feature samples
2025-07-13 08:40:49,464 - __main__ - INFO - Creating training targets
2025-07-13 08:40:49,464 - simple_targets - INFO - Generating training targets for 641 feature samples from 714 time points
2025-07-13 08:40:49,465 - simple_targets - INFO - Creating occupancy targets for 641 time points
2025-07-13 08:40:51,442 - simple_targets - INFO - Processing target 0/641
2025-07-13 08:40:56,421 - simple_targets - INFO - Target office_occupancy_15min: mean=0.214, std=0.343
2025-07-13 08:40:56,421 - simple_targets - INFO - Target office_occupancy_2h: mean=0.506, std=0.455
2025-07-13 08:40:56,421 - simple_targets - INFO - Target bedroom_occupancy_15min: mean=0.055, std=0.126
2025-07-13 08:40:56,421 - simple_targets - INFO - Target bedroom_occupancy_2h: mean=0.368, std=0.397
2025-07-13 08:40:56,421 - simple_targets - INFO - Target kitchen_livingroom_occupancy_15min: mean=0.171, std=0.309
2025-07-13 08:40:56,422 - simple_targets - INFO - Target kitchen_livingroom_occupancy_2h: mean=0.545, std=0.442
2025-07-13 08:40:56,422 - simple_targets - INFO - Generated occupancy targets for 641 samples
2025-07-13 08:40:56,422 - simple_targets - INFO - Generated targets with shapes:
2025-07-13 08:40:56,422 - simple_targets - INFO -   office_occupancy_15min: (641,) (min=0.000, max=1.000)
2025-07-13 08:40:56,422 - simple_targets - INFO -   office_occupancy_2h: (641,) (min=0.000, max=1.000)
2025-07-13 08:40:56,422 - simple_targets - INFO -   bedroom_occupancy_15min: (641,) (min=0.000, max=0.875)
2025-07-13 08:40:56,422 - simple_targets - INFO -   bedroom_occupancy_2h: (641,) (min=0.000, max=1.000)
2025-07-13 08:40:56,422 - simple_targets - INFO -   kitchen_livingroom_occupancy_15min: (641,) (min=0.000, max=1.000)
2025-07-13 08:40:56,422 - simple_targets - INFO -   kitchen_livingroom_occupancy_2h: (641,) (min=0.000, max=1.000)
2025-07-13 08:40:56,422 - __main__ - INFO - Training ML models
2025-07-13 08:40:56,423 - simple_models - INFO - Fitting simple ML pipeline
2025-07-13 08:40:56,423 - simple_models - INFO - Fitting occupancy prediction models
2025-07-13 08:41:19,710 - simple_models - INFO - Fitted office 15-min model with 641 samples
2025-07-13 08:42:08,653 - simple_models - INFO - Fitted office 2h model with 641 samples
2025-07-13 08:42:34,162 - simple_models - INFO - Fitted bedroom 15-min model with 641 samples
2025-07-13 08:43:22,961 - simple_models - INFO - Fitted bedroom 2h model with 641 samples
2025-07-13 08:43:48,575 - simple_models - INFO - Fitted kitchen_livingroom 15-min model with 641 samples
2025-07-13 08:44:18,445 - simple_models - INFO - Fitted kitchen_livingroom 2h model with 641 samples
2025-07-13 08:44:18,446 - simple_models - INFO - Occupancy prediction models fitted successfully
2025-07-13 08:44:18,446 - simple_models - INFO - Simple ML pipeline fitted successfully
2025-07-13 08:44:18,478 - simple_models - INFO - SimpleModelPipeline saved to /home/intent-predictor/ha-intent-predictor/models/simple_pipeline.joblib
2025-07-13 08:44:18,479 - simple_feature_engine - INFO - SimpleFeatureEngine saved to /home/intent-predictor/ha-intent-predictor/models/simple_feature_engine.joblib
2025-07-13 08:44:18,479 - __main__ - INFO - Models saved to disk
2025-07-13 08:44:18,485 - __main__ - INFO - Initial training completed successfully
2025-07-13 08:44:18,487 - __main__ - INFO - Initial training completed successfully
2025-07-13 08:44:18,487 - __main__ - INFO - Scheduled periodic tasks
2025-07-13 08:44:18,487 - __main__ - INFO - Application initialized successfully
 * Serving Flask app 'main'
 * Debug mode: off
Address already in use
Port 8000 is in use by another program. Either identify and stop that program, or start the server with a different port.
2025-07-13 08:45:18,490 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:45:21,026 - ha_client - INFO - Retrieved 4138 historical records
2025-07-13 08:45:21,717 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:46:21,717 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:46:24,327 - ha_client - INFO - Retrieved 4138 historical records
2025-07-13 08:46:25,073 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:47:25,074 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:47:27,609 - ha_client - INFO - Retrieved 4138 historical records
2025-07-13 08:47:28,408 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:48:28,409 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:48:30,995 - ha_client - INFO - Retrieved 4137 historical records
2025-07-13 08:48:31,708 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:49:31,709 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:49:34,264 - ha_client - INFO - Retrieved 4134 historical records
2025-07-13 08:49:34,952 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:50:34,952 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:50:37,480 - ha_client - INFO - Retrieved 4132 historical records
2025-07-13 08:50:38,173 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:51:38,174 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:51:40,724 - ha_client - INFO - Retrieved 4130 historical records
2025-07-13 08:51:41,443 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:52:41,443 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:52:43,989 - ha_client - INFO - Retrieved 4130 historical records
2025-07-13 08:52:44,684 - ha_client - INFO - Updated 12/12 sensors successfully
2025-07-13 08:53:44,685 - ha_client - INFO - Fetching 1 days of historical data for 23 entities
2025-07-13 08:53:47,242 - ha_client - INFO - Retrieved 4130 historical records
2025-07-13 08:53:47,943 - ha_client - INFO - Updated 12/12 sensors successfully
